#!/usr/bin/env python3
"""Format tmux command outputs for display/paste."""
import sys

# Read entries from command line argument or stdin
if len(sys.argv) > 1:
    data = sys.argv[1]
else:
    data = sys.stdin.read().strip()

# Parse entries and sort by index
entries = []
for entry in data.split('\n'):
    if not entry:
        continue

    parts = entry.split('|||')
    if len(parts) < 3:
        continue

    try:
        index = int(parts[0])
        cmd = parts[1]
        output = parts[2].replace('\\n', '\n')
        entries.append((index, cmd, output))
    except (ValueError, IndexError):
        continue

# Sort by index to get chronological order
entries.sort(key=lambda x: x[0])

# Format output
result = []
for i, (_, cmd, output) in enumerate(entries):
    # Add blank line between entries (except first)
    if i > 0:
        result.append('')

    # Format as "$ command" followed by output
    result.append(f'$ {cmd}\n{output}')

print('\n'.join(result), end='')
